# TradeFlow å¯åŠ¨æŒ‡å—

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. ç¯å¢ƒè¦æ±‚

- **Python**: >= 3.10
- **Node.js**: >= 18.0.0
- **Docker** (å¯é€‰): ç”¨äºå®¹å™¨åŒ–éƒ¨ç½²
- **MongoDB**: æ•°æ®åº“æœåŠ¡
- **Redis**: ç¼“å­˜æœåŠ¡

### 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€

è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æµ‹å½“å‰æœåŠ¡çŠ¶æ€ï¼š

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow
./check_status.sh  # å¦‚æœå­˜åœ¨æ­¤è„šæœ¬
```

## ğŸš€ å¯åŠ¨æ–¹å¼

### æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨å¯åŠ¨ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

#### 1. å¯åŠ¨æ•°æ®åº“æœåŠ¡

**MongoDB**:
```bash
# ä½¿ç”¨ Docker å¯åŠ¨ MongoDB
docker run -d --name mongodb \
  -p 27017:27017 \
  -v mongodb_data:/data/db \
  mongo:latest

# æˆ–ä½¿ç”¨æœ¬åœ°å®‰è£…çš„ MongoDB
mongod --dbpath /path/to/data
```

**Redis**:
```bash
# ä½¿ç”¨ Docker å¯åŠ¨ Redis
docker run -d --name redis \
  -p 6379:6379 \
  redis:latest

# æˆ–ä½¿ç”¨æœ¬åœ°å®‰è£…çš„ Redis
redis-server
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼š

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow
cp .env.example .env  # å¦‚æœæœ‰ç¤ºä¾‹æ–‡ä»¶
# æˆ–æ‰‹åŠ¨åˆ›å»º .env æ–‡ä»¶
```

é…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼ˆå‚è€ƒ `config/settings.json` æˆ–é¡¹ç›®æ–‡æ¡£ï¼‰ã€‚

#### 3. å®‰è£…åç«¯ä¾èµ–

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow

# ä½¿ç”¨ pip
pip install -r requirements.txt

# æˆ–ä½¿ç”¨ uvï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
uv pip install -r requirements.txt
```

#### 4. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow
python -m app
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

**éªŒè¯åç«¯**:
```bash
curl http://localhost:8000/api/health
```

#### 5. å¯åŠ¨å‰ç«¯æœåŠ¡

åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­ï¼š

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow/frontend

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install
# æˆ–
yarn install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
# æˆ–
yarn dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ `http://localhost:3000` å¯åŠ¨ï¼ˆæˆ–æ ¹æ® vite.config.ts é…ç½®çš„ç«¯å£ï¼‰ã€‚

**è®¿é—®å‰ç«¯**: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3000`

### æ–¹å¼äºŒï¼šä½¿ç”¨ Docker Composeï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰

#### 1. å¯åŠ¨æ‰€æœ‰æœåŠ¡

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow
docker-compose up -d
```

è¿™å°†å¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š
- åç«¯æœåŠ¡ (FastAPI)
- å‰ç«¯æœåŠ¡ (Vue 3)
- MongoDB æ•°æ®åº“
- Redis ç¼“å­˜

#### 2. æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
docker-compose ps
```

#### 3. æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
docker-compose logs -f mongodb
docker-compose logs -f redis
```

#### 4. åœæ­¢æœåŠ¡

```bash
docker-compose down
```

#### 5. é‡å¯æœåŠ¡

```bash
docker-compose restart
# æˆ–
docker-compose down && docker-compose up -d
```

### æ–¹å¼ä¸‰ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬

å¦‚æœé¡¹ç›®ä¸­æœ‰å¯åŠ¨è„šæœ¬ï¼š

#### å¯åŠ¨åç«¯

```bash
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow
./restart_backend.sh  # å¦‚æœå­˜åœ¨
```

#### å¯åŠ¨æ‰€æœ‰æœåŠ¡

```bash
./restart_all.sh  # å¦‚æœå­˜åœ¨
```

## ğŸ” éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ

### æ£€æŸ¥åç«¯

1. **å¥åº·æ£€æŸ¥**:
   ```bash
   curl http://localhost:8000/api/health
   ```

2. **API æ–‡æ¡£** (å¼€å‘æ¨¡å¼):
   è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹ Swagger API æ–‡æ¡£

3. **æ£€æŸ¥ç«¯å£**:
   ```bash
   lsof -i :8000
   ```

### æ£€æŸ¥å‰ç«¯

1. **æµè§ˆå™¨è®¿é—®**: `http://localhost:3000`

2. **æ£€æŸ¥ç«¯å£**:
   ```bash
   lsof -i :3000
   ```

### æ£€æŸ¥æ•°æ®åº“

1. **MongoDB**:
   ```bash
   # ä½¿ç”¨ Docker
   docker ps | grep mongodb
   
   # æµ‹è¯•è¿æ¥
   nc -z localhost 27017
   ```

2. **Redis**:
   ```bash
   # ä½¿ç”¨ Docker
   docker ps | grep redis
   
   # æµ‹è¯•è¿æ¥
   redis-cli ping
   # æˆ–
   nc -z localhost 6379
   ```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“ä¾èµ–**: ç¡®ä¿ MongoDB å’Œ Redis å·²å¯åŠ¨
   - MongoDB é»˜è®¤ç«¯å£ï¼š27017
   - Redis é»˜è®¤ç«¯å£ï¼š6379

2. **ç¯å¢ƒå˜é‡**: ç¡®ä¿å·²é…ç½® `.env` æ–‡ä»¶ï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰
   - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
   - API å¯†é’¥ï¼ˆå¦‚ OpenAIã€Google AI ç­‰ï¼‰
   - JWT å¯†é’¥
   - å…¶ä»–é…ç½®é¡¹

3. **Python ç¯å¢ƒ**: ç¡®ä¿å·²æ¿€æ´»æ­£ç¡®çš„ Python è™šæ‹Ÿç¯å¢ƒæˆ– conda ç¯å¢ƒ
   ```bash
   # ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   # æˆ–
   venv\Scripts\activate  # Windows
   ```

4. **Node.js ç‰ˆæœ¬**: å‰ç«¯éœ€è¦ Node.js >= 18.0.0
   ```bash
   node --version
   ```

5. **ç«¯å£å ç”¨**: ç¡®ä¿ 8000 å’Œ 3000 ç«¯å£æœªè¢«å…¶ä»–ç¨‹åºå ç”¨
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   lsof -i :8000
   lsof -i :3000
   ```

6. **æ•°æ®åŒæ­¥**: åœ¨åˆ†æè‚¡ç¥¨ä¹‹å‰ï¼Œè¯·æŒ‰ç›¸å…³æ–‡æ¡£è¦æ±‚ï¼Œå°†è‚¡ç¥¨æ•°æ®åŒæ­¥å®Œæˆï¼Œå¦åˆ™åˆ†æç»“æœå°†ä¼šå‡ºç°æ•°æ®é”™è¯¯ã€‚

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### åç«¯æ— æ³•å¯åŠ¨

1. **æ£€æŸ¥ Python ç¯å¢ƒå’Œä¾èµ–**:
   ```bash
   python --version
   pip list | grep fastapi
   pip list | grep uvicorn
   ```

2. **æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨**:
   ```bash
   lsof -i :8000
   # å¦‚æœè¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ app/main.py ä¸­çš„ç«¯å£é…ç½®
   ```

3. **æŸ¥çœ‹åç«¯æ—¥å¿—**:
   ```bash
   tail -f logs/webapi.log
   # æˆ–
   tail -f logs/backend.log
   ```

4. **æ£€æŸ¥æ•°æ®åº“è¿æ¥**:
   - ç¡®è®¤ MongoDB å’Œ Redis æœåŠ¡æ­£åœ¨è¿è¡Œ
   - æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥é…ç½®

### å‰ç«¯æ— æ³•å¯åŠ¨

1. **æ£€æŸ¥ Node.js ç‰ˆæœ¬**:
   ```bash
   node --version
   # éœ€è¦ >= 18.0.0
   ```

2. **å®‰è£…ä¾èµ–**:
   ```bash
   cd frontend
   npm install
   # æˆ–
   yarn install
   ```

3. **æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨**:
   ```bash
   lsof -i :3000
   # å¦‚æœè¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ vite.config.ts ä¸­çš„ç«¯å£é…ç½®
   ```

4. **æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å®‰è£…**:
   ```bash
   cd frontend
   rm -rf node_modules package-lock.json
   npm install
   ```

5. **æ£€æŸ¥ç¯å¢ƒå˜é‡**:
   - ç¡®è®¤ `frontend/.env` æˆ– `frontend/.env.local` ä¸­çš„ `VITE_API_BASE_URL` é…ç½®æ­£ç¡®

### æ•°æ®åº“è¿æ¥é—®é¢˜

1. **MongoDB è¿æ¥å¤±è´¥**:
   ```bash
   # æ£€æŸ¥ MongoDB æ˜¯å¦è¿è¡Œ
   docker ps | grep mongodb
   # æˆ–
   nc -z localhost 27017
   
   # æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
   # åœ¨ .env æ–‡ä»¶ä¸­ç¡®è®¤ MONGODB_URL é…ç½®æ­£ç¡®
   ```

2. **Redis è¿æ¥å¤±è´¥**:
   ```bash
   # æ£€æŸ¥ Redis æ˜¯å¦è¿è¡Œ
   docker ps | grep redis
   # æˆ–
   redis-cli ping
   
   # æ£€æŸ¥è¿æ¥é…ç½®
   # åœ¨ .env æ–‡ä»¶ä¸­ç¡®è®¤ REDIS_URL é…ç½®æ­£ç¡®
   ```

### ç™»å½•é—®é¢˜

1. **æ£€æŸ¥åç«¯ API**:
   ```bash
   curl -X POST http://localhost:8000/api/auth/login \
     -H "Content-Type: application/json" \
     -d '{"username":"admin","password":"admin"}'
   ```

2. **æ£€æŸ¥ CORS é…ç½®**:
   - ç¡®è®¤åç«¯ `app/main.py` ä¸­çš„ CORS é…ç½®å…è®¸å‰ç«¯åŸŸå

3. **æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°**:
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
   - æŸ¥çœ‹ Network æ ‡ç­¾é¡µä¸­çš„è¯·æ±‚å’Œå“åº”
   - æŸ¥çœ‹ Console æ ‡ç­¾é¡µä¸­çš„é”™è¯¯ä¿¡æ¯

### å…¶ä»–å¸¸è§é—®é¢˜

1. **ä¾èµ–ç‰ˆæœ¬å†²çª**:
   ```bash
   # æ›´æ–°ä¾èµ–
   pip install --upgrade -r requirements.txt
   npm update
   ```

2. **æƒé™é—®é¢˜**:
   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x restart_backend.sh
   chmod +x restart_all.sh
   ```

3. **ç£ç›˜ç©ºé—´ä¸è¶³**:
   ```bash
   df -h
   # æ¸…ç† Docker é•œåƒå’Œå®¹å™¨
   docker system prune -a
   ```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **API æ–‡æ¡£**: `http://localhost:8000/docs` (å¼€å‘æ¨¡å¼)
- **é¡¹ç›®æ–‡æ¡£**: `docs/` ç›®å½•
- **é…ç½®æ–‡ä»¶**: `config/` ç›®å½•
- **å¯åŠ¨æ£€æŸ¥æ¸…å•**: `å¯åŠ¨æ£€æŸ¥æ¸…å•.md` (å¦‚æœå­˜åœ¨)
- **é…ç½®è¯´æ˜**: `é…ç½®è¯´æ˜.md` (å¦‚æœå­˜åœ¨)

## ğŸ¯ å¿«é€Ÿå¯åŠ¨å‘½ä»¤æ€»ç»“

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/yinshuo/Documents/2025/code/TradeFlow/TradeFlow

# 2. å¯åŠ¨æ•°æ®åº“ï¼ˆå¦‚æœæœªè¿è¡Œï¼‰
docker run -d --name mongodb -p 27017:27017 mongo:latest
docker run -d --name redis -p 6379:6379 redis:latest

# 3. å¯åŠ¨åç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
python -m app

# 4. å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend && npm run dev

# æˆ–ä½¿ç”¨ Docker Compose ä¸€é”®å¯åŠ¨
docker-compose up -d
```

## ğŸ’¡ æç¤º

- é¦–æ¬¡å¯åŠ¨å»ºè®®ä½¿ç”¨ Docker Composeï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†æ‰€æœ‰ä¾èµ–
- å¼€å‘æ—¶å»ºè®®ä½¿ç”¨æ‰‹åŠ¨å¯åŠ¨æ–¹å¼ï¼Œä¾¿äºè°ƒè¯•
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ Docker Compose æˆ– Docker éƒ¨ç½²
- å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

