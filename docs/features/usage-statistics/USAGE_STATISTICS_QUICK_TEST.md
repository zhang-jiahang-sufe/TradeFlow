# ä½¿ç”¨ç»Ÿè®¡åŠŸèƒ½å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯ä½¿ç”¨ç»Ÿè®¡å’Œå®šä»·é…ç½®åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. å¯åŠ¨åç«¯æœåŠ¡

```powershell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd d:\code\TradingAgents-CN

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\.venv\Scripts\Activate.ps1

# å¯åŠ¨åç«¯
.\.venv\Scripts\python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```powershell
# æ–°å¼€ä¸€ä¸ªç»ˆç«¯
cd d:\code\TradingAgents-CN\frontend

# å¯åŠ¨å‰ç«¯
npm run dev
```

### 3. ç™»å½•ç³»ç»Ÿ

è®¿é—® `http://localhost:5173` å¹¶ç™»å½•ã€‚

## âœ… æµ‹è¯•æ­¥éª¤

### æµ‹è¯• 1ï¼šé…ç½®æ¨¡å‹å®šä»·

#### æ­¥éª¤
1. è®¿é—® `http://localhost:5173/settings/config`
2. ç‚¹å‡»"å¤§æ¨¡å‹é…ç½®"æ ‡ç­¾
3. æ‰¾åˆ°ä¸€ä¸ªæ¨¡å‹ï¼ˆå¦‚ qwen-maxï¼‰
4. ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®
5. æ»šåŠ¨åˆ°"å®šä»·é…ç½®"éƒ¨åˆ†
6. å¡«å†™ï¼š
   - è¾“å…¥ä»·æ ¼: `0.0200`
   - è¾“å‡ºä»·æ ¼: `0.0600`
   - è´§å¸å•ä½: `CNY`
7. ç‚¹å‡»"ä¿å­˜"

#### é¢„æœŸç»“æœ
- âœ… ä¿å­˜æˆåŠŸæç¤º
- âœ… æ¨¡å‹å¡ç‰‡æ˜¾ç¤ºå®šä»·ä¿¡æ¯ï¼š
  ```
  ğŸ’° å®šä»·:
    è¾“å…¥: 0.0200 CNY/1K
    è¾“å‡º: 0.0600 CNY/1K
  ```

### æµ‹è¯• 2ï¼šè®¿é—®ä½¿ç”¨ç»Ÿè®¡é¡µé¢ï¼ˆæ–¹å¼ 1ï¼‰

#### æ­¥éª¤
1. ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„"è®¾ç½®"
2. åœ¨è®¾ç½®é¡µé¢é¡¶éƒ¨ï¼Œç¡®è®¤å½“å‰åœ¨"ç³»ç»Ÿé…ç½®"æ ‡ç­¾
3. åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡»"ä½¿ç”¨ç»Ÿè®¡"
4. ç‚¹å‡»"æŸ¥çœ‹ä½¿ç”¨ç»Ÿè®¡"æŒ‰é’®

#### é¢„æœŸç»“æœ
- âœ… è·³è½¬åˆ°ä½¿ç”¨ç»Ÿè®¡é¡µé¢
- âœ… URL å˜ä¸º `/settings/usage`
- âœ… é¡µé¢æ­£å¸¸åŠ è½½

### æµ‹è¯• 3ï¼šè®¿é—®ä½¿ç”¨ç»Ÿè®¡é¡µé¢ï¼ˆæ–¹å¼ 2ï¼‰

#### æ­¥éª¤
1. ç›´æ¥åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ï¼š`http://localhost:5173/settings/usage`
2. æŒ‰å›è½¦

#### é¢„æœŸç»“æœ
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… æ˜¾ç¤ºä½¿ç”¨ç»Ÿè®¡ç•Œé¢

### æµ‹è¯• 4ï¼šæŸ¥çœ‹ç»Ÿè®¡æ¦‚è§ˆ

#### æ­¥éª¤
1. åœ¨ä½¿ç”¨ç»Ÿè®¡é¡µé¢é¡¶éƒ¨æŸ¥çœ‹ 4 ä¸ªç»Ÿè®¡å¡ç‰‡

#### é¢„æœŸç»“æœ
- âœ… æ˜¾ç¤º"æ€»è¯·æ±‚æ•°"å¡ç‰‡
- âœ… æ˜¾ç¤º"æ€»è¾“å…¥ Token"å¡ç‰‡
- âœ… æ˜¾ç¤º"æ€»è¾“å‡º Token"å¡ç‰‡
- âœ… æ˜¾ç¤º"æ€»æˆæœ¬"å¡ç‰‡
- âœ… å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤º 0

### æµ‹è¯• 5ï¼šæŸ¥çœ‹å›¾è¡¨

#### æ­¥éª¤
1. æ»šåŠ¨åˆ°å›¾è¡¨åŒºåŸŸ
2. æŸ¥çœ‹ä¸‰ä¸ªå›¾è¡¨

#### é¢„æœŸç»“æœ
- âœ… æ˜¾ç¤º"æŒ‰ä¾›åº”å•†ç»Ÿè®¡"é¥¼å›¾
- âœ… æ˜¾ç¤º"æŒ‰æ¨¡å‹ç»Ÿè®¡"æŸ±çŠ¶å›¾
- âœ… æ˜¾ç¤º"æ¯æ—¥æˆæœ¬è¶‹åŠ¿"æŠ˜çº¿å›¾
- âœ… å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤º"æš‚æ— æ•°æ®"

### æµ‹è¯• 6ï¼šæ—¶é—´èŒƒå›´ç­›é€‰

#### æ­¥éª¤
1. ç‚¹å‡»å³ä¸Šè§’çš„æ—¶é—´èŒƒå›´é€‰æ‹©å™¨
2. é€‰æ‹©"æœ€è¿‘ 30 å¤©"
3. ç­‰å¾…æ•°æ®åˆ·æ–°

#### é¢„æœŸç»“æœ
- âœ… æ•°æ®é‡æ–°åŠ è½½
- âœ… å›¾è¡¨æ›´æ–°
- âœ… ç»Ÿè®¡å¡ç‰‡æ›´æ–°

### æµ‹è¯• 7ï¼šæŸ¥çœ‹ä½¿ç”¨è®°å½•è¡¨æ ¼

#### æ­¥éª¤
1. æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨
2. æŸ¥çœ‹ä½¿ç”¨è®°å½•è¡¨æ ¼

#### é¢„æœŸç»“æœ
- âœ… æ˜¾ç¤ºè¡¨æ ¼
- âœ… æ˜¾ç¤ºåˆ—ï¼šæ—¶é—´ã€ä¾›åº”å•†ã€æ¨¡å‹ã€è¾“å…¥Tokenã€è¾“å‡ºTokenã€æˆæœ¬ã€åˆ†æç±»å‹ã€ä¼šè¯ID
- âœ… å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤º"æš‚æ— æ•°æ®"
- âœ… æ˜¾ç¤ºåˆ†é¡µæ§ä»¶

### æµ‹è¯• 8ï¼šåˆ·æ–°æ•°æ®

#### æ­¥éª¤
1. ç‚¹å‡»å³ä¸Šè§’çš„"åˆ·æ–°"æŒ‰é’®

#### é¢„æœŸç»“æœ
- âœ… æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- âœ… æ•°æ®é‡æ–°åŠ è½½
- âœ… æ˜¾ç¤ºæˆåŠŸæç¤º

### æµ‹è¯• 9ï¼šæ¸…ç†æ—§è®°å½•

#### æ­¥éª¤
1. ç‚¹å‡»"æ¸…ç†æ—§è®°å½•"æŒ‰é’®
2. åœ¨ç¡®è®¤å¯¹è¯æ¡†ä¸­ç‚¹å‡»"ç¡®å®š"

#### é¢„æœŸç»“æœ
- âœ… æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
- âœ… æ˜¾ç¤ºåˆ é™¤æˆåŠŸæç¤º
- âœ… æ•°æ®åˆ·æ–°

## ğŸ”§ ç”Ÿæˆæµ‹è¯•æ•°æ®

å¦‚æœæ²¡æœ‰ä½¿ç”¨æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç”Ÿæˆï¼š

### æ–¹å¼ 1ï¼šè¿è¡Œè‚¡ç¥¨åˆ†æ

1. è®¿é—®"è‚¡ç¥¨åˆ†æ > å•è‚¡åˆ†æ"
2. è¾“å…¥è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ 600519ï¼‰
3. ç‚¹å‡»"å¼€å§‹åˆ†æ"
4. ç­‰å¾…åˆ†æå®Œæˆ

### æ–¹å¼ 2ï¼šä½¿ç”¨ API ç›´æ¥æ·»åŠ æµ‹è¯•æ•°æ®

```python
# scripts/add_test_usage_data.py
import asyncio
from datetime import datetime, timedelta
import random
from app.services.usage_statistics_service import usage_statistics_service
from app.models.config import UsageRecord

async def add_test_data():
    """æ·»åŠ æµ‹è¯•ä½¿ç”¨æ•°æ®"""
    providers = ['dashscope', 'openai', 'google']
    models = {
        'dashscope': ['qwen-max', 'qwen-plus', 'qwen-turbo'],
        'openai': ['gpt-4', 'gpt-3.5-turbo'],
        'google': ['gemini-pro']
    }
    
    # ç”Ÿæˆæœ€è¿‘ 30 å¤©çš„æ•°æ®
    for i in range(30):
        date = datetime.now() - timedelta(days=i)
        
        # æ¯å¤©ç”Ÿæˆ 5-10 æ¡è®°å½•
        for _ in range(random.randint(5, 10)):
            provider = random.choice(providers)
            model = random.choice(models[provider])
            
            input_tokens = random.randint(500, 3000)
            output_tokens = random.randint(200, 1500)
            
            # å‡è®¾ä»·æ ¼
            input_price = 0.02
            output_price = 0.06
            cost = (input_tokens / 1000) * input_price + (output_tokens / 1000) * output_price
            
            record = UsageRecord(
                timestamp=date.isoformat(),
                provider=provider,
                model_name=model,
                input_tokens=input_tokens,
                output_tokens=output_tokens,
                cost=cost,
                session_id=f"test_session_{i}_{_}",
                analysis_type="stock_analysis"
            )
            
            await usage_statistics_service.add_usage_record(record)
    
    print("æµ‹è¯•æ•°æ®æ·»åŠ å®Œæˆï¼")

if __name__ == "__main__":
    asyncio.run(add_test_data())
```

è¿è¡Œè„šæœ¬ï¼š
```powershell
.\.venv\Scripts\python scripts/add_test_usage_data.py
```

## ğŸ“Š éªŒè¯ç»“æœ

### æˆåŠŸæ ‡å‡†

- âœ… æ‰€æœ‰é¡µé¢æ­£å¸¸åŠ è½½
- âœ… å®šä»·é…ç½®å¯ä»¥ä¿å­˜
- âœ… å®šä»·ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
- âœ… ä½¿ç”¨ç»Ÿè®¡é¡µé¢å¯ä»¥è®¿é—®
- âœ… ç»Ÿè®¡æ•°æ®æ­£ç¡®æ˜¾ç¤º
- âœ… å›¾è¡¨æ­£å¸¸æ¸²æŸ“
- âœ… æ—¶é—´èŒƒå›´ç­›é€‰æ­£å¸¸å·¥ä½œ
- âœ… åˆ·æ–°åŠŸèƒ½æ­£å¸¸
- âœ… æ¸…ç†æ—§è®°å½•åŠŸèƒ½æ­£å¸¸

### æ£€æŸ¥ç‚¹

1. **åç«¯ API**
   - è®¿é—® `http://localhost:8000/docs`
   - æŸ¥çœ‹ `usage-statistics` æ ‡ç­¾ä¸‹çš„ API
   - æµ‹è¯•å„ä¸ªç«¯ç‚¹

2. **å‰ç«¯è·¯ç”±**
   - æ£€æŸ¥ `/settings/usage` è·¯ç”±æ˜¯å¦æ³¨å†Œ
   - æ£€æŸ¥é¡µé¢æ˜¯å¦å¯ä»¥è®¿é—®

3. **æ•°æ®åº“**
   - æ£€æŸ¥ MongoDB ä¸­æ˜¯å¦æœ‰ `usage_records` é›†åˆ
   - æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®å­˜å‚¨

4. **æµè§ˆå™¨æ§åˆ¶å°**
   - æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
   - æ£€æŸ¥ API è¯·æ±‚æ˜¯å¦æˆåŠŸ

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šé¡µé¢ 404

**åŸå› **: è·¯ç”±æœªæ­£ç¡®æ³¨å†Œ

**è§£å†³**:
1. æ£€æŸ¥ `frontend/src/router/index.ts`
2. ç¡®è®¤ `UsageStatistics` è·¯ç”±å·²æ·»åŠ 
3. é‡å¯å‰ç«¯æœåŠ¡

### é—®é¢˜ 2ï¼šå›¾è¡¨ä¸æ˜¾ç¤º

**åŸå› **: ECharts æœªæ­£ç¡®åŠ è½½æˆ–æ²¡æœ‰æ•°æ®

**è§£å†³**:
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. ç¡®è®¤æœ‰ä½¿ç”¨æ•°æ®
3. å°è¯•åˆ·æ–°é¡µé¢

### é—®é¢˜ 3ï¼šAPI è¯·æ±‚å¤±è´¥

**åŸå› **: åç«¯æœåŠ¡æœªå¯åŠ¨æˆ–è®¤è¯å¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
3. æ£€æŸ¥ JWT token æ˜¯å¦æœ‰æ•ˆ

### é—®é¢˜ 4ï¼šå®šä»·ä¸æ˜¾ç¤º

**åŸå› **: å®šä»·é…ç½®æœªä¿å­˜æˆ–æ•°æ®æœªåˆ·æ–°

**è§£å†³**:
1. é‡æ–°ä¿å­˜å®šä»·é…ç½®
2. åˆ·æ–°é¡µé¢
3. æ£€æŸ¥ MongoDB ä¸­çš„æ•°æ®

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```markdown
# ä½¿ç”¨ç»Ÿè®¡åŠŸèƒ½æµ‹è¯•æŠ¥å‘Š

## æµ‹è¯•ç¯å¢ƒ
- æ“ä½œç³»ç»Ÿ: Windows 11
- æµè§ˆå™¨: Chrome 120
- åç«¯ç‰ˆæœ¬: v1.0.0-preview
- å‰ç«¯ç‰ˆæœ¬: v1.0.0-preview

## æµ‹è¯•ç»“æœ

| æµ‹è¯•é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|--------|------|------|
| é…ç½®æ¨¡å‹å®šä»· | âœ… | æ­£å¸¸ |
| è®¿é—®ç»Ÿè®¡é¡µé¢ï¼ˆæ–¹å¼1ï¼‰ | âœ… | æ­£å¸¸ |
| è®¿é—®ç»Ÿè®¡é¡µé¢ï¼ˆæ–¹å¼2ï¼‰ | âœ… | æ­£å¸¸ |
| æŸ¥çœ‹ç»Ÿè®¡æ¦‚è§ˆ | âœ… | æ­£å¸¸ |
| æŸ¥çœ‹å›¾è¡¨ | âœ… | æ­£å¸¸ |
| æ—¶é—´èŒƒå›´ç­›é€‰ | âœ… | æ­£å¸¸ |
| æŸ¥çœ‹ä½¿ç”¨è®°å½• | âœ… | æ­£å¸¸ |
| åˆ·æ–°æ•°æ® | âœ… | æ­£å¸¸ |
| æ¸…ç†æ—§è®°å½• | âœ… | æ­£å¸¸ |

## å‘ç°çš„é—®é¢˜
æ— 

## å»ºè®®
æ— 

## æµ‹è¯•äººå‘˜
[å§“å]

## æµ‹è¯•æ—¥æœŸ
2025-10-07
```

## ğŸš€ ä¸‹ä¸€æ­¥

æµ‹è¯•é€šè¿‡åï¼š
1. æäº¤ä»£ç åˆ° Git
2. æ›´æ–°ç‰ˆæœ¬å·
3. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
4. é€šçŸ¥ç”¨æˆ·æ–°åŠŸèƒ½ä¸Šçº¿

